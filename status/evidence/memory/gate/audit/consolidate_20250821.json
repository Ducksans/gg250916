{
  "type": "consolidation_memo",
  "version": "v1",
  "utc_ts": "2025-08-21T08:04:41Z",
  "scope": "BT-12 ST-1204 (Memory Gate)",
  "author": "Zed Gumgang",
  "policy": {
    "non_destructive": true,
    "no_delete": true,
    "append_only": true
  },
  "summary": "Multiple approvals were made for identical ultra_long content (before duplicate guard hardening). This memo designates a single primary record and marks the others as duplicates for downstream readers (UI/search) without removing any data.",
  "groups": [
    {
      "approved_sha256": "b3009ab0969727c88b506bd857b28e4719368918c4a18f738214fcbda6d97f75",
      "text_excerpt": "L5 게이트 핵심 지식",
      "primary": {
        "id": "06CCQ24XTK2F8ESXYE4BAV8FP4",
        "path": "status/evidence/memory/gate/approved/20250821/06CCQ24XTK2F8ESXYE4BAV8FP4.json",
        "approved_at": "2025-08-21T07:39:29.246361Z",
        "reason": "earliest approved record for identical text (pre-guard)"
      },
      "duplicates": [
        {
          "id": "06CCQ4PJX0SCSRP6K26QMX8Z88",
          "path": "status/evidence/memory/gate/approved/20250821/06CCQ4PJX0SCSRP6K26QMX8Z88.json",
          "approved_at": "2025-08-21T07:40:53.873646Z"
        },
        {
          "id": "06CCQ63FW2PEFJ82DRNM5FRSJW",
          "path": "status/evidence/memory/gate/approved/20250821/06CCQ63FW2PEFJ82DRNM5FRSJW.json",
          "approved_at": "2025-08-21T07:47:01.745353Z"
        },
        {
          "id": "06CCQ6RFG01VHZXR2P7E2BGDXM",
          "path": "status/evidence/memory/gate/approved/20250821/06CCQ6RFG01VHZXR2P7E2BGDXM.json",
          "approved_at": "2025-08-21T07:49:53.676777Z"
        }
      ],
      "l5_entries": [
        {
          "jsonl": "status/evidence/memory/tiers/ultra_long/20250821/GG-SESS-LOCAL.jsonl",
          "record_id": "ultra_long_20250821_1755761969241"
        },
        {
          "jsonl": "status/evidence/memory/tiers/ultra_long/20250821/GG-SESS-LOCAL.jsonl",
          "record_id": "ultra_long_20250821_1755762053873"
        },
        {
          "jsonl": "status/evidence/memory/tiers/ultra_long/20250821/GG-SESS-LOCAL.jsonl",
          "record_id": "ultra_long_20250821_1755762421745"
        },
        {
          "jsonl": "status/evidence/memory/tiers/ultra_long/20250821/GG-SESS-LOCAL.jsonl",
          "record_id": "ultra_long_20250821_1755762593676"
        }
      ],
      "proposed_actions": [
        "Patch duplicate approved JSON files to add consolidate: { primary_id: \"06CCQ24XTK2F8ESXYE4BAV8FP4\", reason: \"duplicate_sha256\" }",
        "Keep all L5 JSONL lines as-is (append-only). Readers (UI/search) should prefer the primary and badge others as duplicate.",
        "Create a lightweight backlink map (future): primary -> duplicates, duplicates -> primary, to aid UI filtering and analytics."
      ],
      "rationale": "Pre-guard approvals allowed identical text multiple times. After hardening, the gate returns 409 DUPLICATE for this text. We consolidate to a single authoritative approved record without data loss."
    }
  ],
  "evidence": {
    "approved_dir": "status/evidence/memory/gate/approved/20250821",
    "l5_ultra_long": "status/evidence/memory/tiers/ultra_long/20250821/GG-SESS-LOCAL.jsonl",
    "audit": "status/evidence/memory/gate/audit/20250821/audit.jsonl",
    "stats": "status/evidence/memory/gate/audit/stats_20250821.json",
    "smoke_plan": "status/evidence/memory/tests/ST-1204_smoke_plan.md"
  },
  "compat_notes": [
    "This memo does not delete or rewrite any historical records.",
    "UI/search should implement a consolidation-aware view: show primary by default; duplicates collapsed with a 'duplicate' badge.",
    "Future compaction (optional) can merge identical L5 lines under a single logical entry keyed by primary_id."
  ],
  "next_step": "Apply non-destructive patches to duplicate approved records to reference the primary_id and update UI to hide duplicates by default."
}
