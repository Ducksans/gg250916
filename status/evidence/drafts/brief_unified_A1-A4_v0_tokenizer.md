---
phase: past
---

# [브리프] A1–A4 단일 화면 v0 + 토크나이저 연동 — 서명 준비(Explain-before-execute)

문맥(Context)
- 기준 체크포인트/서명: GG-TR-0013(CHECKPOINT) · GG-TR-0014(SIGN_OFF)
- 현재 위치: “1. Zed 환경에서 금강 소울 완전 이식”의 말미를 고정했고, “2. 금강 사용자 인터페이스(User Interface, UI) 구축 및 안정화” 입구에 섰습니다.
- SSOT(Single Source of Truth, 단일 진실 원천) `/gumgang_meeting/docs`는 프리즈(읽기 전용) 상태 유지, 운영 증거는 `/gumgang_meeting/status/evidence`와 `/gumgang_meeting/ui/logs`에 적재합니다.

목표(1문장)
- A1~A4를 한 화면으로 정적으로 묶은 v0 스냅샷을 만들고, 토크나이저(Tokenizer, 토큰화 도구)를 연결하여 모델 컨텍스트 용량을 실제로 계측·관리하는 운영 루프를 세웁니다.

사람 말 요약(3줄)
- “한 장짜리 상황판”을 만든다: A1(채팅)·A2(세션/태스크)·A3(도구 패널)·A4(상태/로그)를 탭/패널로 한 화면에 모읍니다.
- “얼마나 담을 수 있나”를 눈으로 확인한다: 모델별 토큰을 실제로 세고(계측), 70/85/95% 임계값에서 자동으로 요약/압축/링크화를 실행합니다.
- 모든 흔적은 남긴다: 요청/응답과 요약·절단 사유·해시를 증거 폴더와 로그에 남겨 “부끄럽지 않은 서명”의 근거로 씁니다.

무엇이 바뀌고, 무엇은 안 바뀌나
- 바뀌는 것
  - 화면: A1~A4가 “한 화면 v0(정적 합성)”으로 제공됩니다(탭/패널 전환).
  - 운영: 토큰 계측·임계값 정책이 실제 로그와 함께 작동합니다.
  - 증거: 스크린샷/로그/요약물이 표준 경로에 축적됩니다.
- 안 바뀌는 것
  - SSOT 프리즈 원칙: `/docs`는 여전히 읽기 전용입니다.
  - 불변식 7과 게이트 기반 진행: 정책·체크리스트·증거 우선 원칙 유지.
  - 개인정보(PII)·비밀키 노출 금지: 레드액션/환경변수 사용 원칙 준수.

범위(Scope) / 비범위(Out of scope)
- 범위
  - A1~A4 단일 화면 v0(정적 합성, 최소 상호작용), 기본 탭/패널 전환.
  - 토크나이저 계측(모델별 컨텍스트, 헤드룸, 임계값 정책 연동).
  - 요청/응답/요약 로그와 무결성 해시(SHA-256) 기록.
- 비범위
  - 프로덕션 등급 인증/권한관리, 복잡한 스트리밍 처리, 다모델 오케스트레이션.
  - SSOT 수정/발행(운영 단계에서는 하지 않음).

산출물(Deliverables)
1) 단일 화면 스냅샷 v0: A1~A4 탭/패널을 한 화면에 정적으로 구성한 HTML(또는 동등 산출물).
2) 토큰 계측·임계값 운영 규칙: 모델별 컨텍스트 크기·헤드룸·임계값(70/85/95%)에 맞춘 “요약/압축/링크화” 실행 로직의 설계 문서.
3) 운영 로그와 증거: 요청/응답 메타(토큰 수, 임계값 이벤트, 요약본, 해시), 스크린샷.
4) 사람 말 설명서(본 문서)와 체크리스트: 서명 전 검토용.

수용 기준(Acceptance Criteria)
- A1~A4 단일 화면 v0
  - 네 패널이 한 화면에 탭/패널 전환 방식으로 모두 표시된다(섹션 헤더 포함).
  - 기본 상호작용 1개 이상(예: 입력란·토글)이 동작한다(스텁 가능).
  - 스크린샷 1장 이상을 남긴다(파일명 규칙 포함).
- 토크나이저 연동
  - Large Language Model(대형 언어 모델, LLM) 호출 전·후 토큰 수를 계측한다(모델·인코딩 명시).
  - 임계값 70/85/95%에 도달 시, 각각 “오래된 메시지 절단 → 요약 승격 → 증거 링크화”가 기록과 함께 실행된 흔적이 남는다.
  - 토큰 집계와 임계값 이벤트가 로그로 남고, 대표 항목은 SHA-256 해시로 고정된다.
- 증거·문서화
  - 로그(JSON/MD), 스크린샷, 브리프/체크리스트가 지정 경로에 존재한다.
  - “어떤 입력에 어떤 요약/절단이 발생했는가”를 한 눈에 복기 가능한 인덱스가 있다.

증거 계획(Evidence Plan)
- 스냅샷/화면
  - `gumgang_meeting/ui/logs/ui_mvp_gate_20250816/screenshots/` (통합 화면 v0 캡처 추가)
  - `gumgang_meeting/ui/proto/` 또는 `gumgang_meeting/ui/snapshots/` (정적 산출물)
- 로그/보고
  - `gumgang_meeting/ui/logs/…` (요청/응답, 토큰 수, 임계값 이벤트, 요약본 경로)
  - `gumgang_meeting/status/evidence/drafts/…` (본 브리프, 운영 규칙 초안)
- 레퍼런스
  - `gumgang_meeting/status/where_are_we.md`
  - `gumgang_meeting/context_observer/protocol.md`, `…/retention_policy.md`
  - `gumgang_meeting/memory/memory.log` (체크포인트/서명 ENTRY)

운영 원칙(안전·보안·개인정보)
- 키/환경: API 키는 환경 변수(또는 OS 키링)로만 사용, 저장소에 절대 커밋 금지.
- 데이터: 민감정보(PII) 입력 금지, 불가피 시 즉시 비식별화.
- 무결성: 중요 로그는 SHA-256 해시 고정(내보내기 파일과 함께 기록).

롤백 계획(Rollback)
- 화면: 단일 화면 v0 산출물을 비활성화하고, 기존 A1~A3 개별 프로토타입 경로로 즉시 되돌린다.
- 운영: 임계값 정책을 “로그만 기록(실제 절단/요약 비활성화)” 모드로 전환한다.
- 기록: 롤백 시각·사유를 `memory/memory.log`에 1줄 ENTRY로 남긴다.

리스크와 대응
- 토큰 계측 편차(모델/인코딩 불일치) → 모델별 인코딩 테이블과 샘플 세트로 교차 검증.
- 임계값 과도 트리거(대화 손실) → “요약 우선, 절단 최소화” 정책과 사용자 확인 토글.
- 증거 누락 → 체크포인트마다 스크린샷·로그·해시를 체크리스트로 강제.

타임라인(48시간 기준)
- T+0~6h: 단일 화면 v0 레이아웃 확정, 토크나이저 계측 설계 문서 초안, 증거 폴더 준비.
- T+6~24h: 화면 v0 산출, 토큰 계측/임계값 이벤트 로깅 연결, 초기 스크린샷/로그 확보.
- T+24~48h: 요약/절단/링크화 운영 문서 확정, 최종 스크린샷/로그/해시, 롤업 갱신.

체크리스트(서명 전)
- [ ] A1~A4 탭/패널이 한 화면에 보인다(헤더 포함).
- [ ] LLM 호출 전·후 토큰 수가 로그에 남는다(모델/인코딩 명시).
- [ ] 70/85/95% 임계값 이벤트가 최소 1회 이상 재현되었다(로그·스크린샷 존재).
- [ ] 요약/절단/링크화 결과물이 경로·해시와 함께 기록되었다.
- [ ] 키/민감정보가 저장소에 노출되지 않았다.
- [ ] 롤백 방법이 문서에 명시되었다.

역할
- 오너(Owner): 덕산 — 이해·질문·서명·최종 승인
- 파트너(Partner): 로컬 금강 — 설계·스캐폴딩·검증·증거 수집

참고 용어(처음 등장 순서 규칙 준수)
- User Interface(사용자 인터페이스, UI)
- Large Language Model(대형 언어 모델, LLM)
- Minimum Viable Product(최소 실행 가능 제품, MVP)
- Single Source of Truth(단일 진실 원천, SSOT)
- Tokenizer(토큰화 도구, 토크나이저)
- Rolling Summary(롤링 요약)

SIGNED(서명 완료) — GG-TR-0016
- 의도(한 문장): 단일 화면 v0와 실제 토큰 계측·임계값 운영을 연결해 “보이는 흐름 + 측정 가능한 한계 + 증거”를 한 번에 갖추기 위함.
- 서명 전 확인: 완료
- 서명(덕산):
  - 이름/이니셜: 덕산
  - LOCAL/UTC 시각: 2025-08-16 23:34 KST (UTC+09:00) / 2025-08-16T14:34:00Z
  - 선언: 서명 및 승인 플래그 <덕산 2025년 8월 16일 23시 34분 한국 시각 | 금강의 제안을 수용하고 충분한  이해를 기반으로 실행을 승인합니다.>
  - 범위: Unified A1–A4 v0 + Tokenizer Integration
- 실행 후 기록:
  - `gumgang_meeting/memory/memory.log`에 SIGNATURE ENTRY 기록: GG-TR-0016 (LOCAL 2025-08-16 23:34 KST / UTC 2025-08-16T14:34:00Z)
  - 증거: `/gumgang_meeting/status/evidence/drafts/brief_unified_A1-A4_v0_tokenizer.md` (본 문서)

부록 — 산출물/로그 권장 경로
- 화면 산출물: `gumgang_meeting/ui/snapshots/unified_A1-A4_v0/`
- 로그(JSON): `gumgang_meeting/ui/logs/…`
- 스크린샷: `gumgang_meeting/ui/logs/ui_mvp_gate_20250816/screenshots/`
- 운영 문서(드래프트): `gumgang_meeting/status/evidence/drafts/`

끝. 덕산의 이해가 우선입니다. “질문 → 해소 → 서명 → 실행” 순서를 지킵니다.