# 실행 계획 보고서 — Dev UI 마이그레이션 및 채팅 로직 복원 (EXEC_PLAN_MIGRATION_AND_CHAT_RESTORE)

- 문서 버전: v1.0
- 작성자: Gemini (금강 AI)
- 작성 시각: 2025-09-11T11:24Z (UTC) / 2025-09-11 20:24 (KST)
- 적용 범위: gumgang_meeting/**
- SSOT 참조:
  - 미래(로드맵): status/roadmap/BT11_to_BT21_Compass_ko.md
  - 현재(아키텍처): status/reports/forensic_report_v1.md
  - 과거(복구 계획): status/restore/UI_RESTORE_SSOT.md

---

## 0) 배경과 목적

- 현재 스냅샷 UI(http://localhost:3037/ui/snapshots/unified_A1-A4_v0/index.html#a1)는 “사실/기억 기반 대화(증거 주입)”가 가능하나, 단일 거대 HTML 구조로 인해 유지보수/디버깅 비용이 큼.
- Dev UI(http://localhost:5173/ui-dev/)로 마이그레이션 중이며, 구성 요소(컴포넌트) 기반으로 분해하여 안정성과 변경 용이성을 확보하는 것이 목표.
- 본 문서는 “가장 먼저 채팅 로직 복원”을 달성하기 위한 전체 실행 계획과 우선 순위를 기록한다.

핵심 목표
- Dev UI에서 A1~A4 시절 “기억·증거·기록” 파이프라인을 재현한다.
- 스냅샷의 오케스트레이션(sendChat) 로직을 Dev UI의 상태/컴포넌트 구조에 맞게 이식한다.
- MCP-Lite(도구 호출)로 파일 시스템/웹 크롤링을 단계적으로 확장한다.
- Tauri 빌드 안정화, Monaco 에디터 활성화, “코딩 전용 에이전틱 AI” 환경으로 확장한다.

---

## 1) 실행 순서(제안 · 승인 대상)

사전 빠른 점검(0)
- Backend 8000, Bridge 3037 헬스 OK 확인.
- Dev UI base(/ui-dev/), 프록시(/api, /bridge) 동작 확인.

1. 스냅샷 채팅 응답 경로 재확인(즉시 가능)
- 경로: http://localhost:3037/ui/snapshots/unified_A1-A4_v0/index.html#a1
- 목적: 현재 환경에서 정상적으로 “증거 블럭 + 응답” 흐름이 살아있는지 재확인.

2. “대화 스레드 복구” (가장 먼저 수행할 실제 구현)
- 소스: /home/duksan/바탕화면/gumgang_meeting/migrated_chat_store.json
- 목표: Dev UI(5173)의 스레드/메시지 구조(chatStore.ts)에 마이그레이션하여 좌측 Thread 리스트 및 타임라인에서 열람 가능.

3. “채팅 로직 복원” (Dev UI에 기억·증거·기록 파이프라인 이식)
- 파이프라인: Recall → Strict Gate → Reason → Record(+Checkpoints trigger)
- A1Dev.jsx의 `send` 경로와 `chatStore.ts`에 로직을 모듈화/주입.

4. 파일 컨트롤용 MCP 확장(Zed 유사)
- 도구: fs.list, fs.read(기존), fs.write, fs.move, fs.delete (프로젝트 경계/제외 패턴 준수)
- 프론트: ToolsManager/ToolsPanel에서 파라미터 입력 + 수동 실행/선택형 Tool Mode.

5. 웹 크롤링/스크래핑 MCP
- 1차: HTTP 기반 web.fetch(url), web.scrape(url, selector[, attr]) + 화이트리스트/사이즈 가드
- 2차(옵션): 헤드리스 렌더(web.render)로 확장(브릿지/별도 모듈 스폰).

6. 에이전트 설정 UI 활성화
- Agents 페이지(시스템 프롬프트/모델/툴셋 CoT 템플릿), 저장은 chatStore.ts upsertAgent 사용.

7. Tauri 빌드 안정화 → Monaco/Agentic Dev 환경
- 프리플라이트 → dev/build 스모크 → 에디터 탑재 → MCP와 왕복 편집/적용 흐름.

승인 시 오늘은 2→3 순서로 바로 진입(“스레드 복구” → “채팅 로직 복원”).

---

## 2) 즉시 작업 — 채팅 로직 복원(Dev UI)

대상
- 프런트:
  - ui/dev_a1_vite/src/components/A1Dev.jsx
  - ui/dev_a1_vite/src/state/
...
